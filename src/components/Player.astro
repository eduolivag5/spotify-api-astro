---
// Interfaz visual del reproductor (Static Aesthetic)
---

<div 
  id="global-player" 
  class="hidden opacity-0 w-full h-full flex items-center justify-between px-6 transition-all duration-700 ease-in-out backdrop-blur-xl border-t border-white/5"
>
  <div class="flex items-center gap-4 w-[30%] min-w-[200px]">
    <div class="relative h-14 w-14 flex-shrink-0 group cursor-default">
       <img id="player-img" src="" alt="" class="h-full w-full rounded-lg object-cover shadow-2xl bg-zinc-800 transition-transform duration-500 group-hover:scale-105" />
       <div class="absolute inset-0 rounded-lg ring-1 ring-inset ring-white/10"></div>
    </div>
    <div class="flex flex-col min-w-0">
      <span id="player-name" class="truncate text-sm font-black text-white leading-tight tracking-tight"></span>
      <span id="player-artist" class="truncate text-[11px] text-zinc-500 font-bold uppercase tracking-[0.1em] mt-1"></span>
    </div>
  </div>

  <div class="flex flex-col items-center max-w-[40%] w-full gap-3">
    <div class="flex items-center gap-8 text-zinc-500">
      <button class="hover:text-white transition-all active:scale-90 cursor-default">
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 448 512">
          <path d="M64 468V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12v176.4l195.5-181C352.1 22.3 384 36.6 384 64v384c0 27.4-31.9 41.7-52.5 24.6L136 292.7V468c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12z"/>
        </svg>
      </button>

      <button class="flex h-14 w-14 items-center justify-center text-white transition-transform hover:scale-110 active:scale-95 cursor-default">
        <svg class="w-full h-full" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9V8h2v8zm4 0h-2V8h2v8z"/>
        </svg>
      </button>

      <button class="hover:text-white transition-all active:scale-90 cursor-default">
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 448 512">
          <path d="M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6L116.5 471.4C95.9 488.5 64 474.2 64 448V64c0-26.2 31.9-40.5 52.5-23.4L312 220.4V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z"/>
        </svg>
      </button>
    </div>
    
    <div class="flex items-center gap-3 w-full px-2">
      <span class="text-[10px] text-zinc-600 font-mono font-bold">1:24</span>
      <div class="h-1.5 flex-1 bg-white/10 rounded-full overflow-hidden relative cursor-default group">
        <div class="h-full bg-[#1DB954] w-[35%] rounded-full relative shadow-[0_0_10px_rgba(29,185,84,0.4)]">
        </div>
      </div>
      <span class="text-[10px] text-zinc-600 font-mono font-bold">3:42</span>
    </div>
  </div>

  <div class="flex items-center justify-end gap-4 w-[30%] min-w-[200px]">
    <button class="text-zinc-500 hover:text-white transition-colors">
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18c-.31-.11-.65-.18-1-.18-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3V8h3V6h-5z"/></svg>
    </button>
    <div class="flex items-center gap-2 group w-28">
      <svg class="w-4 h-4 text-zinc-500" fill="currentColor" viewBox="0 0 24 24"><path d="M7 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.26 2.5-4.02z"/></svg>
      <div class="h-1 flex-1 bg-white/10 rounded-full overflow-hidden">
        <div class="h-full bg-zinc-400 w-3/4"></div>
      </div>
    </div>
  </div>
</div>

<script>
  interface PlayerTrack {
    name: string;
    artist: string;
    image: string;
  }

  const updatePlayer = (detail: PlayerTrack) => {
    const player = document.getElementById('global-player');
    const img = document.getElementById('player-img') as HTMLImageElement;
    const nameEl = document.getElementById('player-name');
    const artistEl = document.getElementById('player-artist');

    if (player && img && nameEl && artistEl) {
      img.src = detail.image;
      nameEl.innerText = detail.name;
      artistEl.innerText = detail.artist;
      
      player.classList.remove('hidden');
      // Forzar reflujo para la animaciÃ³n de opacidad
      void player.offsetWidth;
      player.classList.add('opacity-100');
    }
  };

  document.addEventListener('spotify:play', (e: Event) => {
    const customEvent = e as CustomEvent<PlayerTrack>;
    updatePlayer(customEvent.detail);
  });
</script>